# راهنمای عیب‌یابی سیستم آلارم

## مشکلات رایج و راه‌حل‌ها

### 1. **اپ کرش می‌کند هنگام راه‌اندازی**

**علت احتمالی:**

- مجوزهای Android درست تنظیم نشده
- فایل‌های صوتی موجود نیست
- خطا در راه‌اندازی سرویس‌ها

**راه‌حل:**

```bash
# پاک کردن cache و rebuild
flutter clean
flutter pub get
flutter run
```

### 2. **آلارم کار نمی‌کند**

**علت احتمالی:**

- مجوزهای لازم داده نشده
- فایل صدای آلارم موجود نیست
- در شبیه‌ساز تست می‌کنید

**راه‌حل:**

1. **بررسی مجوزها:**

   - Settings > Apps > Your App > Permissions
   - مجوزهای Notification و Alarm را فعال کنید

2. **بررسی فایل صوتی:**

   - فایل `alarm_sound.mp3` باید در `android/app/src/main/res/raw/` موجود باشد

3. **تست روی دستگاه واقعی:**
   - آلارم‌ها در شبیه‌ساز کار نمی‌کنند
   - حتماً روی گوشی واقعی تست کنید

### 3. **صفحه آلارم باز نمی‌شود**

**علت احتمالی:**

- Navigator key درست تنظیم نشده
- خطا در مدیریت context

**راه‌حل:**

- از نسخه ساده استفاده کنید که کمتر پیچیده است

### 4. **صدا پخش نمی‌شود**

**علت احتمالی:**

- فایل صوتی موجود نیست
- حجم صدا در گوشی کم است
- مجوزهای صوتی داده نشده

**راه‌حل:**

1. فایل صوتی را بررسی کنید
2. حجم صدا را در گوشی بالا ببرید
3. مجوزهای صوتی را فعال کنید

## نسخه ساده سیستم آلارم

برای حل مشکلات، نسخه ساده‌ای ایجاد شده که:

### ✅ **ویژگی‌های نسخه ساده:**

- نوتیفیکیشن ساده بدون پیچیدگی اضافی
- مدیریت خطا بهتر
- کمتر احتمال کرش
- کار در background

### ✅ **فایل‌های نسخه ساده:**

- `lib/core/services/simple_notification_service.dart` - سرویس ساده
- بدون صفحه آلارم پیچیده
- بدون انیمیشن‌های اضافی

## نحوه تست نسخه ساده

1. **تست اولیه:**

   - روی آیکون آلارم در صفحه تسک‌ها کلیک کنید
   - پیام "آلارم تست برای 10 ثانیه بعد تنظیم شد" نمایش داده می‌شود

2. **بررسی لاگ‌ها:**

   - در console پیام‌های زیر را ببینید:

   ```
   HiveService راه‌اندازی شد
   SimpleNotificationService راه‌اندازی شد
   مجوز نوتیفیکیشن درخواست شد
   نوتیفیکیشن ساده برای تست آلارم تنظیم شد
   ```

3. **تست آلارم:**
   - پس از 10 ثانیه، نوتیفیکیشن نمایش داده می‌شود
   - روی نوتیفیکیشن کلیک کنید

## اگر هنوز مشکل دارید

1. **بررسی لاگ‌ها:**

   ```bash
   flutter logs
   ```

2. **تست روی دستگاه مختلف:**

   - Android 10+
   - مجوزهای کامل

3. **استفاده از نسخه ساده:**
   - فعلاً از `SimpleNotificationService` استفاده کنید
   - بعداً نسخه پیشرفته را اضافه کنید

## نکات مهم

- **همیشه روی دستگاه واقعی تست کنید**
- **مجوزهای لازم را بدهید**
- **فایل‌های صوتی را بررسی کنید**
- **لاگ‌ها را چک کنید**
